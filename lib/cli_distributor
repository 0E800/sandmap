#!/usr/bin/env bash

# shellcheck shell=bash

# ``````````````````````````````````````````````````````````````````````````````
# Function name: cli_distributor()
#
# Description:
#   Modules distributor.
#
# Usage:
#   cli_distributor
#
# Examples:
#   cli_distributor
#

function cli_distributor() {

  # shellcheck disable=SC2034
  local _FUNCTION_ID="cli_distributor"
  local _STATE=0

  local _argv=("$@")

  # shellcheck disable=SC2154
  if [[ "${_argv[0]}" == "help" ]] ; then

    if [[ "${_fin[0]}" -eq 0 ]] && [[ "${_fin[1]}" -eq 0 ]]; then

      if [[ "${#_argv[1]}" -eq 0 ]] ; then

        cli_help

        _fin[0]=0

      else

        init_module "${_argv[@]}"
        init_help

        _fin[1]=1

      fi

    else

      init_module "$_ld_module"
      init_help

    fi

  elif [[ "${_argv[0]}" == "show" ]] ; then

    if [[ "${_fin[0]}" -eq 0 ]] && [[ "${_fin[1]}" -eq 0 ]]; then

      if [[ "${#_argv[1]}" -eq 0 ]] ; then

        cli_show

        _fin[0]=0

      else

        init_module "${_argv[@]}"
        init_show

        _fin[1]=1

      fi

      _fin=("$__cli_level")

    else

      init_module "$_ld_module"
      init_show

    fi

  elif [[ "${_argv[0]}" == "reload" ]] ; then

    if [[ "${_fin[0]}" -eq 0 ]] && [[ "${_fin[1]}" -eq 0 ]]; then

      # ReInitialize modules.
      load_modules

      printf "%s\n" "modules reloaded"

    fi

  else

    # shellcheck disable=SC2034
    # _cli_state=1
    _inerr=$(echo "${_argv[@]}" | grep -o "$_fname" | wc -w)
    if [[ "$_inerr" -eq 1 ]] ; then

      _fin[1]=1

      # shellcheck disable=SC2034
      _ld_module="$_fname"

      init_module "$_ld_module"

      "$_ld_module"

      # shellcheck disable=SC2034
      __cli_banner="$_fname"

    fi

  fi

  return $_STATE

}
